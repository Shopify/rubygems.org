<% @title = t(".title") %>
<div class="t-body">
  <h2><%= t ".mfa.multifactor_auth" %></h2>
  <% if @user.mfa_enabled? %>
    <p><%= t(".mfa.enabled_html") %></p>
    <%= form_tag multifactor_auth_path, method: :put, id: "mfa-edit" do %>
      <%= label_tag :level, t(".mfa.level.title"), class: "form__label" %>
      <%# Note: Scrappy version ... this can obviously be DRY'd up %>
      <% if @user.owner_of_most_downloaded_gem? %>
         <%= select_tag :level, options_for_select([
          [t(".mfa.level.ui_and_api"), "ui_and_api"],
          [t(".mfa.level.ui_and_gem_signin"), "ui_and_gem_signin"],
          [t(".mfa.level.ui_only"), "ui_only"],
          ["Deregister device", "disabled"]], @user.mfa_level), class: "form__input form__select" %>
      <% else %>
        <%= select_tag :level, options_for_select([
          [t(".mfa.level.ui_and_api"), "ui_and_api"],
          [t(".mfa.level.ui_and_gem_signin"), "ui_and_gem_signin"],
          [t(".mfa.level.ui_only"), "ui_only"],
          [t(".mfa.level.disabled"), "disabled"]], @user.mfa_level), class: "form__input form__select" %>
      <% end %>
      <div class="text_field">
        <%= label_tag :otp, "OTP code", class: "form__label" %>
        <%= text_field_tag :otp, "", class: "form__input", autocomplete: :off %>
      </div>

      <%# Note: Scrappy version ... this can obviously be DRY'd up %>
      <% if @user.owner_of_most_downloaded_gem? %>
        <%= submit_tag
          t(".mfa.update"),
          class: "form__submit",
          data: { confirm: "âœ‹ You will need to register a new device if you deregister the current device.\n\nDo you want to proceed?" } %>
      <% else %>
        <%= submit_tag t(".mfa.update"), class: "form__submit" %>
      <% end %>
    <% end %>
  <% else %>
    <p>
      <%= t(".mfa.disabled_html") %>
      <%= button_to t(".mfa.go_settings"), new_multifactor_auth_path, method: "get", class: "form__submit" %>
    </p>
  <% end %>
</div>

<div class="t-body">
  <h2><%= link_to t('.reset_password.title'), new_password_path %></h2>
</div>

<div class="t-body">
  <h2><%= link_to t('.api_keys'), profile_api_keys_path %></h2>
</div>

<% if @user.ownerships.any? %>
  <div class="t-body">
    <h2><%= link_to t("notifiers.show.title"), notifier_path %></h2>
  </div>
<% end %>
