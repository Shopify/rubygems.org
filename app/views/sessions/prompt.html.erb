<% @title = t('multifactor_authentication') %>

<% if @user.webauthn_credentials.any? %>
  <div class="t-body">
    <p><%= t(".webauthn_credential_note") %></p>
  </div>

  <%= form_tag webauthn_create_session_path, method: :post, class: "js-webauthn-session--form", data: { options: @webauthn_options.to_json } do %>
    <div class="form_bottom">
      <p hidden class="l-text-red-600 js-webauthn-session--error"></p>

      <%= submit_tag t('.sign_in_with_weauthn_credential'), class: 'js-webauthn-session--submit form__submit form__submit--no-hover' %>
    </div>
  <% end %>
<% end %>

<% if @user.mfa_enabled? && @user.webauthn_credentials.any? %>
  <div class="t-body">
    <hr />
  </div>
<% end %>

<% if @user.mfa_enabled? %>
  <%= form_tag mfa_create_session_path, method: :post, class: "mfa-form" do %>
    <div class="text_field">
      <%= label_tag :otp, t('multifactor_auths.otp_code'), class: 'form__label' %>
      <%= text_field_tag :otp, '', class: 'form__input', autofocus: true, autocomplete: :off %>
    </div>
    <div class="form_bottom">
      <%= submit_tag t('sign_in'), data: { disable_with: t('form_disable_with') }, class: 'form__submit' %>
    </div>
  <% end %>

  <div class="t-body">
    <hr />
  </div>

  <div class="t-body">
    <p><%= t("multifactor_auths.recovery_code_html") %></p>
  </div>

  <%= form_tag mfa_create_session_path, method: :post do %>
    <div class="text_field">
      <%= label_tag :otp, t('.recovery_code'), class: 'form__label' %>
      <%= text_field_tag :otp, '', class: 'form__input', autocomplete: :off %>
    </div>
    <div class="form_bottom">
      <%= submit_tag t('sign_in'), data: { disable_with: t('form_disable_with') }, class: 'form__submit' %>
    </div>
  <% end %>
<% end %>
