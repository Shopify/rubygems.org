<% @title = t(".new_api_key") %>

<div class="t-body">
  <%= form_for @api_key, url: profile_api_keys_path do |f| %>
    <%= label_tag :name, t("api_keys.index.name"), class: "form__label" %>
    <%= f.text_field :name, class: "form__input", autocomplete: :off %>

    <div class="form__group">
      <%= label_tag :scope, t("api_keys.index.scope"), class: "form__label" %>
      <% ApiKey::API_SCOPES.each do |api_scope| %>
        <div class = "form__checkbox__item">
          <%= f.check_box "#{api_scope}", { class: "form__checkbox__input", id: "#{api_scope}" } , "true", "false" %>
          <%= label_tag api_scope, t("api_keys.index.#{api_scope}"), class: "form__checkbox__label" %>
        </div>
      <% end %>
    </div>

    <div class="form__group">
      <%= label_tag :rubygem_id, "Gem Scope", class: "form__label" %>
      <p>What gem do you want to apply the selected scope to?</p>

      <ul id="selected-gem">
        <%= f.text_field :rubygem_id, readonly: true, autocomplete: :off, type: "hidden", class: "#{@api_key.rubygem&.name}" %>
      </ul>
      <%= search_field_tag :rubygem, params[:query], :placeholder => "Enter gem name", :id => 'user_gem_query', :class => "form__input", :autocomplete => "off", :focus => "false" %>
      <ul id="suggest-home" class="suggest-list"></ul>
      <%= label_tag :home_query do %>
        <span class="t-hidden"><%= t('layouts.application.header.search_gem_html') %></span>
      <% end %>
    </div>

    <% unless current_user.mfa_disabled? || current_user.mfa_ui_and_api? %>
      <div class="form__group">
        <%= label_tag :mfa, t(".multifactor_auth"), class: "form__label" %>
        <div class="form__checkbox__item">
          <%= f.check_box :mfa, { class: "form__checkbox__input", id: :mfa, checked: true } , "true", "false" %>
          <%= label_tag :mfa, t(".enable_mfa"), class: "form__checkbox__label" %>
        </div>
      </div>
    <% end %>

    <%= f.submit "Create", class: "form__submit" %>
  <% end %>
</div>
